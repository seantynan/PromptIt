<ul id="promptlet-list"></ul>

<script>
const list = document.getElementById('promptlet-list');
chrome.storage.local.get({ promptlets: [] }, (data) => {
  data.promptlets.forEach(p => {
    const li = document.createElement('li');
    li.textContent = `${p.emoji || ''} ${p.name}`;
    li.dataset.promptlet = p.name;
    li.addEventListener('click', () => {
      chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {
        chrome.runtime.sendMessage({ action: 'runPromptlet', name: p.name, tabId: tabs[0].id, text: window.getSelection().toString() });
        window.close();
      });
    });
    list.appendChild(li);
  });
});
</script>
